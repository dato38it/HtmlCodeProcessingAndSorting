<p><strong>Task:</strong><br>Реализовать программу на Python.<br># Разработка бэкап файлов.<br><strong>Decision:</strong><br>PS C:\Users\tuser\Documents\py&gt; vim .\mrbtsbackup.py<br>PS C:\Users\tuser\Documents\py&gt; cat .\mrbtsbackup.py<br>from ftplib import FTP<br>import os<br>import zipfile<br>import datetime<br>ftp = FTP("tipftp")<br>ftp.login(user="tuser", passwd="tpassword")<br>files = ftp.nlst('/Backups/tdir/')<br>local_dir = '//tdomain.ru/tdir/MRBTS/'<br>xml_files_ftp = [file for file in files if file.endswith('.xml')]<br>#print(xml_files_ftp)<br>'''<br>for file in xml_files_ftp:<br>&nbsp;&nbsp;#print(file)<br>&nbsp;&nbsp;local_file = os.path.join(local_dir, os.path.basename(file))<br>&nbsp;&nbsp;#print(local_file)<br>&nbsp;&nbsp;with open(local_file, 'wb') as tempfile:<br>&nbsp;&nbsp;&nbsp;&nbsp;ftp.retrbinary(f'RETR {file}', tempfile.write)&nbsp;&nbsp;&nbsp;&nbsp;<br>ftp.quit()<br>'''<br>'''<br>archive = zipfile.ZipFile('//tdomain.ru/tdir/MRBTS/IRK{}_{}.zip'.format('', datetime.date.today().strftime("%d-%m-%y")), 'w')<br>for loc_dir, loc_subdir, files_local in os.walk(local_dir):<br>&nbsp;&nbsp;#print(loc_dir)<br>&nbsp;&nbsp;for all_files_local in files_local:<br>&nbsp;&nbsp;&nbsp;&nbsp;#print(all_files_local)<br>&nbsp;&nbsp;&nbsp;&nbsp;if all_files_local.endswith('.xml'):<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xml_files_local=os.path.join(loc_dir, all_files_local)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;archive.write(xml_files_local, os.path.relpath(xml_files_local, local_dir), compress_type = zipfile.ZIP_DEFLATED)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#print(xml_files_local)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#os.remove(xml_files_local)<br>archive.close()<br>'''<br>archive = zipfile.ZipFile('//tdomain.ru/tdir/MRBTS/IRK{}_{}.zip'.format('', datetime.date.today().strftime("%d-%m-%y")), 'w')<br>for file in xml_files_ftp:<br>&nbsp;&nbsp;local_file = os.path.join(local_dir, os.path.basename(file))<br>&nbsp;&nbsp;with open(local_file, 'wb') as tempfile:<br>&nbsp;&nbsp;&nbsp;&nbsp;ftp.retrbinary(f'RETR {file}', tempfile.write)<br>&nbsp;&nbsp;for loc_dir, loc_subdir, files_local in os.walk(local_dir):<br>&nbsp;&nbsp;&nbsp;&nbsp;#print(loc_dir)<br>&nbsp;&nbsp;&nbsp;&nbsp;for all_files_local in files_local:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#print(all_files_local)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if all_files_local.endswith('.xml'):<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xml_files_local=os.path.join(loc_dir, all_files_local)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;archive.write(xml_files_local, os.path.relpath(xml_files_local, local_dir), compress_type = zipfile.ZIP_DEFLATED)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#print(xml_files_local)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;os.remove(xml_files_local)<br>archive.close()<br>ftp.quit()<br>PS C:\Users\tuser\Documents\py&gt; python .\mrbtsbackup.py<br><strong>Source:</strong><br># https://sky.pro/media/rabota-s-fajlami-v-python-kak-poluchit-spisok-vseh-fajlov-v-direktorii/ - Получение списка файлов в директории<br># https://docs.python.org/3/library/ftplib.html<br># https://sky.pro/media/kak-ispolzovat-python-dlya-raboty-s-ftp/<br># https://pythonworld.ru/tipy-dannyx-v-python/spiski-list-funkcii-i-metody-spiskov.html - Таблица "методы списков".<br># https://dvmn.org/encyclopedia/python_intermediate/python_lists/ - Как добавить элемент в список.<br># https://metanit.com/python/tutorial/4.1.php - Открытие и закрытие файла.<br># https://lavrynenko.com/python-ftplib-skachat-fajl/ - Python ftplib скачать файл.<br># https://sky.pro/media/sliyanie-spiskov-v-python-metod-join/ - Простой пример использования join().<br># https://sky.pro/media/zapis-stroki-s-peremennoj-v-tekstovyj-fajl-v-python/ - Запись строки с переменной в текстовый файл в Python.<br># https://ru.stackoverflow.com/questions/1178149/%D0%9A%D0%B0%D0%BA-%D0%B4%D0%BE%D0%B7%D0%B0%D0%BF%D0%B8%D1%81%D0%B0%D1%82%D1%8C-%D1%84%D0%B0%D0%B9%D0%BB-%D0%B2-python - Как дозаписать файл в python.<br># https://metanit.com/python/tutorial/4.7.php - Запись файлов в архив.<br># https://code.tutsplus.com/ru/compressing-and-extracting-files-in-python--cms-26816t - Сжатие Нескольких Файлов.<br># https://sky.pro/media/udalenie-fajla-ili-papki-v-python/ - Удаление файла.<br># https://qna.habr.com/q/896993 - Как создавать файлы с датой в название?<br># https://habr.com/ru/articles/537774/ - Скачивание файла.</p>
